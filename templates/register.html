<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Register - GameHub</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="box">
        <h1>Create Account</h1>

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="flash {{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <form method="POST" onsubmit="return validateForm()">
            <input type="text" name="username" placeholder="Choose Username" required><br>
            <input type="password" id="password" name="password" placeholder="Choose Password" required><br>
            <input type="password" id="confirm_password" name="confirm_password" placeholder="Confirm Password" required><br>
            <select name="role" required>
                <option value="customer">Customer</option>
                <option value="admin">Admin</option>
            </select><br>
            <div id="password-error" style="color: red; display: none;"></div>
            <button type="submit">Create Account</button>
        </form>

        <p><a href="{{ url_for('login') }}">‚Üê Back to Login</a></p>
    </div>
    <script>
        function validateForm() {
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirm_password').value;
            const errorDiv = document.getElementById('password-error');
            const errors = [];

            // Check password match
            if (password !== confirmPassword) {
                errors.push('Passwords do not match.');
            }

            // Validate password strength
            if (password.length < 8) {
                errors.push('Password must be at least 8 characters long.');
            }
            if (!/[A-Z]/.test(password)) {
                errors.push('Password must contain at least one uppercase letter.');
            }
            if (!/[a-z]/.test(password)) {
                errors.push('Password must contain at least one lowercase letter.');
            }
            if (!/\d/.test(password)) {
                errors.push('Password must contain at least one digit.');
            }
            if (!/[!@#$%^&*(),.?":{}|<>]/.test(password)) {
                errors.push('Password must contain at least one special character (e.g., @, #, !).');
            }

            if (errors.length > 0) {
                errorDiv.innerHTML = errors.join('<br>');
                errorDiv.style.display = 'block';
                return false;
            } else {
                errorDiv.style.display = 'none';
                return true;
            }
        }
    </script>
</body>
</html>
